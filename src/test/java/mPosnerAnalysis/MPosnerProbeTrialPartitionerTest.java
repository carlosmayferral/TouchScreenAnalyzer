package mPosnerAnalysis;

import static org.junit.jupiter.api.Assertions.*;

import java.util.List;

import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

import dataModels.Event;
import dataModels.Trial;

class MPosnerProbeTrialPartitionerTest {

	@BeforeEach
	void setUp() throws Exception {
	}

	@Test
	void partitioner_recognizes_first_trial() {
		String input = "0.004,1,Condition Event,Set Blank Images,,1,0,,,,,,,,,,\r\n"
				+ "0.004,32,Whisker - Display Image,Posner task,Background,1,2,Position,1,Image 1,0,,,,,,\r\n"
				+ "0.004,32,Whisker - Display Image,Posner task,Background,1,2,Position,2,Image 1,0,,,,,,\r\n"
				+ "0.004,32,Whisker - Display Image,Posner task,Background,1,2,Position,3,Image 1,0,,,,,,\r\n"
				+ "0.004,3,Output On Event,White_Noise_Off #1,,1,0,,,,,,,,,,\r\n"
				+ "0.004,21,Group Change Event,Group Change,,1,1,New Group,22,,,,,,,,\r\n"
				+ "0.1,1,Condition Event,Reset Sound Levels to Zero,,22,0,,,,,,,,,,\r\n"
				+ "0.1,4,Output Off Event,Sound #1,,22,0,,,,,,,,,,\r\n"
				+ "0.1,4,Output Off Event,Sound #2,,22,0,,,,,,,,,,\r\n"
				+ "0.1,4,Output Off Event,Sound #3,,22,0,,,,,,,,,,\r\n"
				+ "0.1,21,Group Change Event,Group Change,,22,1,New Group,23,,,,,,,,\r\n"
				+ "0.1,1,Condition Event,Adjust Sound Level 2,,23,0,,,,,,,,,,\r\n"
				+ "0.1,3,Output On Event,Sound #2,,23,0,,,,,,,,,,\r\n"
				+ "0.1,1,Condition Event,NoTone Fall Through,,23,0,,,,,,,,,,\r\n"
				+ "0.1,21,Group Change Event,Group Change,,23,1,New Group,24,,,,,,,,\r\n"
				+ "0.1,1,Condition Event,Tone set,,24,0,,,,,,,,,,\r\n"
				+ "0.1,21,Group Change Event,Group Change,,24,1,New Group,2,,,,,,,,\r\n"
				+ "0.1,1,Condition Event,Free Feed,,2,0,,,,,,,,,,\r\n"
				+ "0.1,3,Output On Event,TrayLight #1,,2,0,,,,,,,,,,\r\n"
				+ "0.1,7,Pulse Output Event,Feeder #1,,2,1,Duration,0.28,,,,,,,,\r\n"
				+ "0.1,7,Pulse Output Event,Sound_On #1,,2,1,Duration,1,,,,,,,,\r\n"
				+ "0.1,16,Variable Event,SkipTrial_inc,,2,1,Value,1,,,,,,,,\r\n"
				+ "0.1,21,Group Change Event,Group Change,,2,1,New Group,3,,,,,,,,\r\n"
				+ "19.998,38,Input Transition On Event,Tray #1,,3,0,,,,,,,,,,\r\n"
				+ "19.998,1,Condition Event,Tray Entry starts first trial,,3,0,,,,,,,,,,\r\n"
				+ "19.998,4,Output Off Event,TrayLight #1,,3,0,,,,,,,,,,\r\n"
				+ "19.998,16,Variable Event,Trial_Type,,3,1,Value,14513,,,,,,,,\r\n"
				+ "19.998,19,List Change - Next Value,First_10_Trial,,3,2,Index,6,Value,14513,,,,,,\r\n"
				+ "19.998,16,Variable Event,Starting_Validity,,3,1,Value,12,,,,,,,,\r\n"
				+ "19.998,17,List Change - Set,Validity_List,,3,2,Index,12,Value,0,,,,,,\r\n"
				+ "19.998,16,Variable Event,Cue_Brightness,,3,1,Value,50,,,,,,,,\r\n"
				+ "19.998,19,List Change - Next Value,Valid_CueBrightness,,3,2,Index,7,Value,25,,,,,,\r\n"
				+ "19.998,21,Group Change Event,Group Change,,3,1,New Group,4,,,,,,,,\r\n"
				+ "19.998,1,Condition Event,Select Trial Type,,4,0,,,,,,,,,,\r\n"
				+ "19.998,32,Whisker - Display Image,Posner task,Image,4,2,Position,4,CentralStimulus,0,,,,,,\r\n"
				+ "19.998,16,Variable Event,aTrial_Set,,4,1,Value,14513,,,,,,,,\r\n"
				+ "19.998,16,Variable Event,Hold_Time,,4,1,Value,0.175,,,,,,,,\r\n"
				+ "19.998,21,Group Change Event,Group Change,,4,1,New Group,5,,,,,,,,\r\n"
				+ "19.998,1,Condition Event,Trial set 14513,,5,0,,,,,,,,,,\r\n"
				+ "19.998,16,Variable Event,Cue_Left,,5,1,Value,1,,,,,,,,\r\n"
				+ "19.998,16,Variable Event,Cue_Right,,5,1,Value,0,,,,,,,,\r\n"
				+ "19.998,16,Variable Event,Target_Position,,5,1,Value,1,,,,,,,,\r\n"
				+ "19.998,16,Variable Event,Incorrect_Position,,5,1,Value,3,,,,,,,,\r\n"
				+ "19.998,21,Group Change Event,Group Change,,5,1,New Group,15,,,,,,,,\r\n"
				+ "20.183,39,Input Transition Off Event,Tray #1,,15,0,,,,,,,,,,\r\n"
				+ "20.597,30,Touch Down Event,Posner task,,15,4,Position,4,CentralStimulus,0,CoordX,37,CoordY,79,,\r\n"
				+ "20.597,1,Condition Event,Display Left Cue 50,,15,0,,,,,,,,,,\r\n"
				+ "20.597,32,Whisker - Display Image,Posner task,Cue_Images,15,2,Position,4,LeftCue50,5,,,,,,\r\n"
				+ "20.597,29,Timer Event,Hold_Timer,,15,1,Value,0,,,,,,,,\r\n"
				+ "20.597,21,Group Change Event,Group Change,,15,1,New Group,37,,,,,,,,\r\n"
				+ "20.747,1,Condition Event,Hold_Cue,,37,0,,,,,,,,,,\r\n"
				+ "20.747,32,Whisker - Display Image,Posner task,Image,37,2,Position,4,dim,2,,,,,,\r\n"
				+ "20.747,21,Group Change Event,Group Change,,37,1,New Group,16,,,,,,,,\r\n"
				+ "20.772,1,Condition Event,Hold_CTI,,16,0,,,,,,,,,,\r\n"
				+ "20.772,32,Whisker - Display Image,Posner task,Image,16,2,Position,1,Target,1,,,,,,\r\n"
				+ "20.772,16,Variable Event,Hold_Failure_Counter,,16,1,Value,0,,,,,,,,\r\n"
				+ "20.772,29,Timer Event,zzRT_Timer,,16,1,Value,0,,,,,,,,\r\n"
				+ "20.772,29,Timer Event,Target_Timer,,16,1,Value,0,,,,,,,,\r\n"
				+ "20.772,21,Group Change Event,Group Change,,16,1,New Group,7,,,,,,,,\r\n"
				+ "21.173,31,Touch Up Event,Posner task,,7,4,Position,4,dim,2,CoordX,47,CoordY,71,,\r\n"
				+ "21.173,1,Condition Event,Leave_During Target,,7,0,,,,,,,,,,\r\n"
				+ "21.173,32,Whisker - Display Image,Posner task,Background,7,2,Position,4,Image 1,0,,,,,,\r\n"
				+ "21.173,16,Variable Event,zzRT_Timer,,7,1,Value,0.401,,,,,,,,\r\n"
				+ "21.173,16,Variable Event,Hold_Timer,,7,1,Value,0.576,,,,,,,,\r\n"
				+ "21.173,29,Timer Event,zzMT_Timer,,7,1,Value,0,,,,,,,,\r\n"
				+ "21.173,21,Group Change Event,Group Change,,7,1,New Group,25,,,,,,,,\r\n"
				+ "21.391,30,Touch Down Event,Posner task,,25,4,Position,1,Target,1,CoordX,107,CoordY,130,,\r\n"
				+ "21.391,1,Condition Event,Correct_Leaving During Target,,25,0,,,,,,,,,,\r\n"
				+ "21.391,32,Whisker - Display Image,Posner task,Background,25,2,Position,1,Image 1,0,,,,,,\r\n"
				+ "21.391,7,Pulse Output Event,Feeder #1,,25,1,Duration,0.28,,,,,,,,\r\n"
				+ "21.391,3,Output On Event,TrayLight #1,,25,0,,,,,,,,,,\r\n"
				+ "21.391,7,Pulse Output Event,Sound_On #1,,25,1,Duration,1,,,,,,,,\r\n"
				+ "21.391,16,Variable Event,Target_Timer,,25,1,Value,0.619,,,,,,,,\r\n"
				+ "21.391,16,Variable Event,Target_Timer,,25,1,Value,0,,,,,,,,\r\n"
				+ "21.391,16,Variable Event,zzMT_Timer,,25,1,Value,0.218,,,,,,,,\r\n"
				+ "21.391,21,Group Change Event,Group Change,,25,1,New Group,9,,,,,,,,\r\n"
				+ "21.391,1,Condition Event,Increment Correct_Counter,,9,0,,,,,,,,,,\r\n"
				+ "21.391,16,Variable Event,zz_Correct_Counter,,9,1,Value,1,,,,,,,,\r\n"
				+ "21.391,16,Variable Event,Hold_Success_Counter,,9,1,Value,1,,,,,,,,\r\n"
				+ "21.391,16,Variable Event,aCounter_NoAE,,9,1,Value,1,,,,,,,,\r\n"
				+ "21.391,16,Variable Event,First_Analysis,,9,1,Value,0,,,,,,,,\r\n"
				+ "21.391,16,Variable Event,Change_Hold_Time,,9,1,Value,1,,,,,,,,\r\n"
				+ "21.391,61,Group Maintain Event,Group Change,,9,1,New Group,9,,,,,,,,\r\n"
				+ "21.487,31,Touch Up Event,Posner task,,9,4,Position,1,Image 1,0,CoordX,100,CoordY,130,,\r\n"
				+ "23.195,38,Input Transition On Event,BIRBeam #1,,9,0,,,,,,,,,,\r\n"
				+ "23.298,39,Input Transition Off Event,BIRBeam #1,,9,0,,,,,,,,,,\r\n"
				+ "23.369,38,Input Transition On Event,Tray #1,,9,0,,,,,,,,,,\r\n"
				+ "23.369,1,Condition Event,Reward Collected,,9,0,,,,,,,,,,\r\n"
				+ "23.369,4,Output Off Event,TrayLight #1,,9,0,,,,,,,,,,\r\n"
				+ "23.369,29,Timer Event,After_Reward_Timer,,9,1,Value,0,,,,,,,,\r\n"
				+ "23.369,16,Variable Event,Reward_counter,,9,1,Value,1,,,,,,,,\r\n"
				+ "23.369,21,Group Change Event,Group Change,,9,1,New Group,35,,,,,,,,\r\n"
				+ "23.408,39,Input Transition Off Event,Tray #1,,35,0,,,,,,,,,,\r\n"
				+ "23.447,38,Input Transition On Event,Tray #1,,35,0,,,,,,,,,,\r\n"
				+ "23.551,39,Input Transition Off Event,Tray #1,,35,0,,,,,,,,,,\r\n"
				+ "25.369,1,Condition Event,AfterReward_Pause,,35,0,,,,,,,,,,\r\n"
				+ "25.369,29,Timer Event,ITI_Timer,,35,1,Value,0,,,,,,,,\r\n"
				+ "25.369,16,Variable Event,After_Reward_Timer,,35,1,Value,2,,,,,,,,\r\n"
				+ "25.369,16,Variable Event,After_Reward_Timer,,35,1,Value,0,,,,,,,,\r\n"
				+ "25.369,21,Group Change Event,Group Change,,35,1,New Group,10,,,,,,,,\r\n"
				+ "30.369,1,Condition Event,Next trial,,10,0,,,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,ITI_Timer,,10,1,Value,5,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,ITI_Timer,,10,1,Value,0,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,SkipTrial_inc,,10,1,Value,0,,,,,,,,";
		Event[] events = Event.readEventsFromString(input);
		MPosnerProbeTrialPartitioner sut = new MPosnerProbeTrialPartitioner();
		
		List<Trial> trials = sut.partition(events);
		
		assertEquals(1,trials.size());
		int numberOfEvents = trials.get(0).copyEventsAsArray().length;
		assertEquals("Next trial", trials.get(0).copyEventsAsArray()[numberOfEvents-1].getItem_Name());
	}
	
	@Test
	void partitioner_recognizes_second_trial() {
		String input = "30.369,16,Variable Event,ITI_Timer,,10,1,Value,5,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,ITI_Timer,,10,1,Value,0,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,SkipTrial_inc,,10,1,Value,0,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,First_Analysis,,10,1,Value,1,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,Hold_Timer,,10,1,Value,0.576,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,Hold_Timer,,10,1,Value,0,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,zzRT_Timer,,10,1,Value,0.401,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,zzRT_Timer,,10,1,Value,0,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,zzMT_Timer,,10,1,Value,0.218,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,zzMT_Timer,,10,1,Value,0,,,,,,,,\r\n"
				+ "30.369,21,Group Change Event,Group Change,,10,1,New Group,27,,,,,,,,\r\n"
				+ "30.369,1,Condition Event,Change Hold Time,,27,0,,,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,Hold_Time_Adjuster,,27,1,Value,0.176,,,,,,,,\r\n"
				+ "30.369,21,Group Change Event,Group Change,,27,1,New Group,3,,,,,,,,\r\n"
				+ "30.369,1,Condition Event,First 10 trials,,3,0,,,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,_Trial_Counter,,3,1,Value,1,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,Correct_Percent,,3,1,Value,1,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,Correct_Percent,,3,1,Value,1,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,Correct_Percent,,3,1,Value,100,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,Accuracy_NoAE,,3,1,Value,1,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,Accuracy_NoAE,,3,1,Value,1,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,Accuracy_NoAE,,3,1,Value,100,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,Trial_Type,,3,1,Value,14513,,,,,,,,\r\n"
				+ "30.369,19,List Change - Next Value,First_10_Trial,,3,2,Index,5,Value,4531,,,,,,\r\n"
				+ "30.369,16,Variable Event,Cue_Brightness,,3,1,Value,25,,,,,,,,\r\n"
				+ "30.369,19,List Change - Next Value,Valid_CueBrightness,,3,2,Index,10,Value,12.5,,,,,,\r\n"
				+ "30.369,21,Group Change Event,Group Change,,3,1,New Group,4,,,,,,,,\r\n"
				+ "30.369,1,Condition Event,Select Trial Type,,4,0,,,,,,,,,,\r\n"
				+ "30.369,32,Whisker - Display Image,Posner task,Image,4,2,Position,4,CentralStimulus,0,,,,,,\r\n"
				+ "30.369,16,Variable Event,aTrial_Set,,4,1,Value,14513,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,Hold_Time,,4,1,Value,0.176,,,,,,,,\r\n"
				+ "30.369,21,Group Change Event,Group Change,,4,1,New Group,5,,,,,,,,\r\n"
				+ "30.369,1,Condition Event,Trial set 14513,,5,0,,,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,Cue_Left,,5,1,Value,1,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,Cue_Right,,5,1,Value,0,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,Target_Position,,5,1,Value,1,,,,,,,,\r\n"
				+ "30.369,16,Variable Event,Incorrect_Position,,5,1,Value,3,,,,,,,,\r\n"
				+ "30.369,21,Group Change Event,Group Change,,5,1,New Group,15,,,,,,,,\r\n"
				+ "58.599,30,Touch Down Event,Posner task,,15,4,Position,4,CentralStimulus,0,CoordX,78,CoordY,25,,\r\n"
				+ "58.6,1,Condition Event,Display Left Cue 25,,15,0,,,,,,,,,,\r\n"
				+ "58.6,32,Whisker - Display Image,Posner task,Cue_Images,15,2,Position,4,LeftCue25,6,,,,,,\r\n"
				+ "58.6,29,Timer Event,Hold_Timer,,15,1,Value,0,,,,,,,,\r\n"
				+ "58.6,21,Group Change Event,Group Change,,15,1,New Group,37,,,,,,,,\r\n"
				+ "58.75,1,Condition Event,Hold_Cue,,37,0,,,,,,,,,,\r\n"
				+ "58.75,32,Whisker - Display Image,Posner task,Image,37,2,Position,4,dim,2,,,,,,\r\n"
				+ "58.75,21,Group Change Event,Group Change,,37,1,New Group,16,,,,,,,,\r\n"
				+ "58.776,1,Condition Event,Hold_CTI,,16,0,,,,,,,,,,\r\n"
				+ "58.776,32,Whisker - Display Image,Posner task,Image,16,2,Position,1,Target,1,,,,,,\r\n"
				+ "58.776,16,Variable Event,Hold_Failure_Counter,,16,1,Value,0,,,,,,,,\r\n"
				+ "58.776,29,Timer Event,zzRT_Timer,,16,1,Value,0,,,,,,,,\r\n"
				+ "58.776,29,Timer Event,Target_Timer,,16,1,Value,0,,,,,,,,\r\n"
				+ "58.776,21,Group Change Event,Group Change,,16,1,New Group,7,,,,,,,,\r\n"
				+ "59.252,31,Touch Up Event,Posner task,,7,4,Position,4,dim,2,CoordX,65,CoordY,44,,\r\n"
				+ "59.253,1,Condition Event,Leave_During Target,,7,0,,,,,,,,,,\r\n"
				+ "59.253,32,Whisker - Display Image,Posner task,Background,7,2,Position,4,Image 1,0,,,,,,\r\n"
				+ "59.253,16,Variable Event,zzRT_Timer,,7,1,Value,0.477,,,,,,,,\r\n"
				+ "59.253,16,Variable Event,Hold_Timer,,7,1,Value,0.653,,,,,,,,\r\n"
				+ "59.253,29,Timer Event,zzMT_Timer,,7,1,Value,0,,,,,,,,\r\n"
				+ "59.253,21,Group Change Event,Group Change,,7,1,New Group,25,,,,,,,,\r\n"
				+ "59.432,30,Touch Down Event,Posner task,,25,4,Position,1,Target,1,CoordX,138,CoordY,126,,\r\n"
				+ "59.433,1,Condition Event,Correct_Leaving During Target,,25,0,,,,,,,,,,\r\n"
				+ "59.433,32,Whisker - Display Image,Posner task,Background,25,2,Position,1,Image 1,0,,,,,,\r\n"
				+ "59.433,7,Pulse Output Event,Feeder #1,,25,1,Duration,0.28,,,,,,,,\r\n"
				+ "59.433,3,Output On Event,TrayLight #1,,25,0,,,,,,,,,,\r\n"
				+ "59.433,7,Pulse Output Event,Sound_On #1,,25,1,Duration,1,,,,,,,,\r\n"
				+ "59.433,16,Variable Event,Target_Timer,,25,1,Value,0.657,,,,,,,,\r\n"
				+ "59.433,16,Variable Event,Target_Timer,,25,1,Value,0,,,,,,,,\r\n"
				+ "59.433,16,Variable Event,zzMT_Timer,,25,1,Value,0.18,,,,,,,,\r\n"
				+ "59.433,21,Group Change Event,Group Change,,25,1,New Group,9,,,,,,,,\r\n"
				+ "59.433,1,Condition Event,Increment Correct_Counter,,9,0,,,,,,,,,,\r\n"
				+ "59.433,16,Variable Event,zz_Correct_Counter,,9,1,Value,2,,,,,,,,\r\n"
				+ "59.433,16,Variable Event,Hold_Success_Counter,,9,1,Value,2,,,,,,,,\r\n"
				+ "59.433,16,Variable Event,aCounter_NoAE,,9,1,Value,2,,,,,,,,\r\n"
				+ "59.433,16,Variable Event,First_Analysis,,9,1,Value,0,,,,,,,,\r\n"
				+ "59.433,16,Variable Event,Change_Hold_Time,,9,1,Value,1,,,,,,,,\r\n"
				+ "59.433,61,Group Maintain Event,Group Change,,9,1,New Group,9,,,,,,,,\r\n"
				+ "59.567,31,Touch Up Event,Posner task,,9,4,Position,1,Image 1,0,CoordX,137,CoordY,126,,\r\n"
				+ "60.205,38,Input Transition On Event,Tray #1,,9,0,,,,,,,,,,\r\n"
				+ "60.205,1,Condition Event,Reward Collected,,9,0,,,,,,,,,,\r\n"
				+ "60.205,4,Output Off Event,TrayLight #1,,9,0,,,,,,,,,,\r\n"
				+ "60.205,29,Timer Event,After_Reward_Timer,,9,1,Value,0,,,,,,,,\r\n"
				+ "60.205,16,Variable Event,Reward_counter,,9,1,Value,2,,,,,,,,\r\n"
				+ "60.205,21,Group Change Event,Group Change,,9,1,New Group,35,,,,,,,,\r\n"
				+ "60.515,39,Input Transition Off Event,Tray #1,,35,0,,,,,,,,,,\r\n"
				+ "62.205,1,Condition Event,AfterReward_Pause,,35,0,,,,,,,,,,\r\n"
				+ "62.205,29,Timer Event,ITI_Timer,,35,1,Value,0,,,,,,,,\r\n"
				+ "62.205,16,Variable Event,After_Reward_Timer,,35,1,Value,2,,,,,,,,\r\n"
				+ "62.205,16,Variable Event,After_Reward_Timer,,35,1,Value,0,,,,,,,,\r\n"
				+ "62.205,21,Group Change Event,Group Change,,35,1,New Group,10,,,,,,,,\r\n"
				+ "67.205,1,Condition Event,Next trial,,10,0,,,,,,,,,,\r\n"
				+ "67.205,16,Variable Event,ITI_Timer,,10,1,Value,5,,,,,,,,\r\n"
				+ "67.205,16,Variable Event,ITI_Timer,,10,1,Value,0,,,,,,,,\r\n"
				+ "67.205,16,Variable Event,SkipTrial_inc,,10,1,Value,0,,,,,,,,\r\n"
				+ "67.205,16,Variable Event,First_Analysis,,10,1,Value,1,,,,,,,,\r\n"
				+ "67.205,16,Variable Event,Hold_Timer,,10,1,Value,0.653,,,,,,,,\r\n"
				+ "67.205,16,Variable Event,Hold_Timer,,10,1,Value,0,,,,,,,,\r\n"
				+ "67.205,16,Variable Event,zzRT_Timer,,10,1,Value,0.477,,,,,,,,\r\n"
				+ "67.205,16,Variable Event,zzRT_Timer,,10,1,Value,0,,,,,,,,\r\n"
				+ "67.205,16,Variable Event,zzMT_Timer,,10,1,Value,0.18,,,,,,,,\r\n"
				+ "67.205,16,Variable Event,zzMT_Timer,,10,1,Value,0,,,,,,,,\r\n"
				+ "67.205,21,Group Change Event,Group Change,,10,1,New Group,27,,,,,,,,";
		Event[] events = Event.readEventsFromString(input);
		MPosnerProbeTrialPartitioner sut = new MPosnerProbeTrialPartitioner();
		
		List<Trial> trials = sut.partition(events);
		
		assertEquals(1,trials.size());
		int numberOfEvents = trials.get(0).copyEventsAsArray().length;
		assertEquals("Next trial", trials.get(0).copyEventsAsArray()[numberOfEvents-1].getItem_Name());
	}
	
	@Test
	void partitioner_recognizes_first_two_trials() {
		String input = "0.005,1,Condition Event,Set Blank Images,,1,0,,,,,,,,,,\r\n"
				+ "0.005,32,Whisker - Display Image,Posner task,Background,1,2,Position,1,Image 1,0,,,,,,\r\n"
				+ "0.005,32,Whisker - Display Image,Posner task,Background,1,2,Position,2,Image 1,0,,,,,,\r\n"
				+ "0.005,32,Whisker - Display Image,Posner task,Background,1,2,Position,3,Image 1,0,,,,,,\r\n"
				+ "0.005,3,Output On Event,White_Noise_Off #1,,1,0,,,,,,,,,,\r\n"
				+ "0.005,21,Group Change Event,Group Change,,1,1,New Group,22,,,,,,,,\r\n"
				+ "0.1,1,Condition Event,Reset Sound Levels to Zero,,22,0,,,,,,,,,,\r\n"
				+ "0.1,4,Output Off Event,Sound #1,,22,0,,,,,,,,,,\r\n"
				+ "0.1,4,Output Off Event,Sound #2,,22,0,,,,,,,,,,\r\n"
				+ "0.1,4,Output Off Event,Sound #3,,22,0,,,,,,,,,,\r\n"
				+ "0.1,21,Group Change Event,Group Change,,22,1,New Group,23,,,,,,,,\r\n"
				+ "0.1,1,Condition Event,Adjust Sound Level 2,,23,0,,,,,,,,,,\r\n"
				+ "0.1,3,Output On Event,Sound #2,,23,0,,,,,,,,,,\r\n"
				+ "0.1,1,Condition Event,NoTone Fall Through,,23,0,,,,,,,,,,\r\n"
				+ "0.1,21,Group Change Event,Group Change,,23,1,New Group,24,,,,,,,,\r\n"
				+ "0.1,1,Condition Event,Tone set,,24,0,,,,,,,,,,\r\n"
				+ "0.1,21,Group Change Event,Group Change,,24,1,New Group,2,,,,,,,,\r\n"
				+ "0.1,1,Condition Event,Free Feed,,2,0,,,,,,,,,,\r\n"
				+ "0.1,3,Output On Event,TrayLight #1,,2,0,,,,,,,,,,\r\n"
				+ "0.1,7,Pulse Output Event,Feeder #1,,2,1,Duration,0.28,,,,,,,,\r\n"
				+ "0.1,7,Pulse Output Event,Sound_On #1,,2,1,Duration,1,,,,,,,,\r\n"
				+ "0.1,16,Variable Event,SkipTrial_inc,,2,1,Value,1,,,,,,,,\r\n"
				+ "0.1,21,Group Change Event,Group Change,,2,1,New Group,3,,,,,,,,\r\n"
				+ "34.831,38,Input Transition On Event,Tray #1,,3,0,,,,,,,,,,\r\n"
				+ "34.831,1,Condition Event,Tray Entry starts first trial,,3,0,,,,,,,,,,\r\n"
				+ "34.831,4,Output Off Event,TrayLight #1,,3,0,,,,,,,,,,\r\n"
				+ "34.831,16,Variable Event,Trial_Type,,3,1,Value,113,,,,,,,,\r\n"
				+ "34.831,19,List Change - Next Value,First_10_Trial,,3,2,Index,6,Value,331,,,,,,\r\n"
				+ "34.831,16,Variable Event,Starting_Validity,,3,1,Value,50,,,,,,,,\r\n"
				+ "34.831,17,List Change - Set,Validity_List,,3,2,Index,50,Value,0,,,,,,\r\n"
				+ "34.831,16,Variable Event,Cue_Brightness,,3,1,Value,50,,,,,,,,\r\n"
				+ "34.831,19,List Change - Next Value,Valid_CueBrightness,,3,2,Index,9,Value,25,,,,,,\r\n"
				+ "34.831,21,Group Change Event,Group Change,,3,1,New Group,4,,,,,,,,\r\n"
				+ "34.832,1,Condition Event,Select Trial Type,,4,0,,,,,,,,,,\r\n"
				+ "34.832,32,Whisker - Display Image,Posner task,Image,4,2,Position,4,CentralStimulus,0,,,,,,\r\n"
				+ "34.832,16,Variable Event,aTrial_Set,,4,1,Value,113,,,,,,,,\r\n"
				+ "34.832,16,Variable Event,Hold_Time,,4,1,Value,0.175,,,,,,,,\r\n"
				+ "34.832,21,Group Change Event,Group Change,,4,1,New Group,5,,,,,,,,\r\n"
				+ "34.832,1,Condition Event,Trial set 113,,5,0,,,,,,,,,,\r\n"
				+ "34.832,16,Variable Event,Cue_Position,,5,1,Value,1,,,,,,,,\r\n"
				+ "34.832,16,Variable Event,Target_Position,,5,1,Value,1,,,,,,,,\r\n"
				+ "34.832,16,Variable Event,Incorrect_Position,,5,1,Value,3,,,,,,,,\r\n"
				+ "34.832,21,Group Change Event,Group Change,,5,1,New Group,15,,,,,,,,\r\n"
				+ "34.991,39,Input Transition Off Event,Tray #1,,15,0,,,,,,,,,,\r\n"
				+ "35.054,38,Input Transition On Event,BIRBeam #1,,15,0,,,,,,,,,,\r\n"
				+ "35.065,39,Input Transition Off Event,BIRBeam #1,,15,0,,,,,,,,,,\r\n"
				+ "35.151,38,Input Transition On Event,FIRBeam #1,,15,0,,,,,,,,,,\r\n"
				+ "35.169,39,Input Transition Off Event,FIRBeam #1,,15,0,,,,,,,,,,\r\n"
				+ "35.39,30,Touch Down Event,Posner task,,15,4,Position,4,CentralStimulus,0,CoordX,60,CoordY,81,,\r\n"
				+ "35.391,1,Condition Event,Display Cue 50,,15,0,,,,,,,,,,\r\n"
				+ "35.391,32,Whisker - Display Image,Posner task,Image,15,2,Position,4,dim,2,,,,,,\r\n"
				+ "35.391,32,Whisker - Display Image,Posner task,Image,15,2,Position,1,Cue50,4,,,,,,\r\n"
				+ "35.391,29,Timer Event,Hold_Timer,,15,1,Value,0,,,,,,,,\r\n"
				+ "35.391,21,Group Change Event,Group Change,,15,1,New Group,37,,,,,,,,\r\n"
				+ "35.541,1,Condition Event,Hold_Cue,,37,0,,,,,,,,,,\r\n"
				+ "35.541,32,Whisker - Display Image,Posner task,Background,37,2,Position,1,Image 1,0,,,,,,\r\n"
				+ "35.541,21,Group Change Event,Group Change,,37,1,New Group,16,,,,,,,,\r\n"
				+ "35.566,1,Condition Event,Hold_CTI,,16,0,,,,,,,,,,\r\n"
				+ "35.566,32,Whisker - Display Image,Posner task,Image,16,2,Position,1,Target,1,,,,,,\r\n"
				+ "35.566,16,Variable Event,Hold_Failure_Counter,,16,1,Value,0,,,,,,,,\r\n"
				+ "35.566,29,Timer Event,zzRT_Timer,,16,1,Value,0,,,,,,,,\r\n"
				+ "35.566,29,Timer Event,Target_Timer,,16,1,Value,0,,,,,,,,\r\n"
				+ "35.566,21,Group Change Event,Group Change,,16,1,New Group,7,,,,,,,,\r\n"
				+ "35.94,38,Input Transition On Event,FIRBeam #1,,7,0,,,,,,,,,,\r\n"
				+ "35.95,31,Touch Up Event,Posner task,,7,4,Position,4,dim,2,CoordX,54,CoordY,84,,\r\n"
				+ "35.95,1,Condition Event,Leave_During Target,,7,0,,,,,,,,,,\r\n"
				+ "35.95,32,Whisker - Display Image,Posner task,Background,7,2,Position,4,Image 1,0,,,,,,\r\n"
				+ "35.95,16,Variable Event,zzRT_Timer,,7,1,Value,0.385,,,,,,,,\r\n"
				+ "35.95,16,Variable Event,Hold_Timer,,7,1,Value,0.56,,,,,,,,\r\n"
				+ "35.95,29,Timer Event,zzMT_Timer,,7,1,Value,0,,,,,,,,\r\n"
				+ "35.95,21,Group Change Event,Group Change,,7,1,New Group,25,,,,,,,,\r\n"
				+ "36.084,39,Input Transition Off Event,FIRBeam #1,,25,0,,,,,,,,,,\r\n"
				+ "36.129,30,Touch Down Event,Posner task,,25,4,Position,1,Target,1,CoordX,107,CoordY,142,,\r\n"
				+ "36.13,1,Condition Event,Correct_Leaving During Target,,25,0,,,,,,,,,,\r\n"
				+ "36.13,32,Whisker - Display Image,Posner task,Background,25,2,Position,1,Image 1,0,,,,,,\r\n"
				+ "36.13,7,Pulse Output Event,Feeder #1,,25,1,Duration,0.28,,,,,,,,\r\n"
				+ "36.13,3,Output On Event,TrayLight #1,,25,0,,,,,,,,,,\r\n"
				+ "36.13,7,Pulse Output Event,Sound_On #1,,25,1,Duration,1,,,,,,,,\r\n"
				+ "36.13,16,Variable Event,Target_Timer,,25,1,Value,0.564,,,,,,,,\r\n"
				+ "36.13,16,Variable Event,Target_Timer,,25,1,Value,0,,,,,,,,\r\n"
				+ "36.13,16,Variable Event,zzMT_Timer,,25,1,Value,0.179,,,,,,,,\r\n"
				+ "36.13,21,Group Change Event,Group Change,,25,1,New Group,9,,,,,,,,\r\n"
				+ "36.13,1,Condition Event,Increment Correct_Counter,,9,0,,,,,,,,,,\r\n"
				+ "36.13,16,Variable Event,zz_Correct_Counter,,9,1,Value,1,,,,,,,,\r\n"
				+ "36.13,16,Variable Event,Hold_Success_Counter,,9,1,Value,1,,,,,,,,\r\n"
				+ "36.13,16,Variable Event,aCounter_NoAE,,9,1,Value,1,,,,,,,,\r\n"
				+ "36.13,16,Variable Event,First_Analysis,,9,1,Value,0,,,,,,,,\r\n"
				+ "36.13,16,Variable Event,Change_Hold_Time,,9,1,Value,1,,,,,,,,\r\n"
				+ "36.13,61,Group Maintain Event,Group Change,,9,1,New Group,9,,,,,,,,\r\n"
				+ "36.218,38,Input Transition On Event,FIRBeam #1,,9,0,,,,,,,,,,\r\n"
				+ "36.258,39,Input Transition Off Event,FIRBeam #1,,9,0,,,,,,,,,,\r\n"
				+ "36.284,31,Touch Up Event,Posner task,,9,4,Position,1,Image 1,0,CoordX,124,CoordY,148,,\r\n"
				+ "36.299,38,Input Transition On Event,FIRBeam #1,,9,0,,,,,,,,,,\r\n"
				+ "36.321,39,Input Transition Off Event,FIRBeam #1,,9,0,,,,,,,,,,\r\n"
				+ "38.269,38,Input Transition On Event,Tray #1,,9,0,,,,,,,,,,\r\n"
				+ "38.27,1,Condition Event,Reward Collected,,9,0,,,,,,,,,,\r\n"
				+ "38.27,4,Output Off Event,TrayLight #1,,9,0,,,,,,,,,,\r\n"
				+ "38.27,29,Timer Event,After_Reward_Timer,,9,1,Value,0,,,,,,,,\r\n"
				+ "38.27,16,Variable Event,Reward_counter,,9,1,Value,1,,,,,,,,\r\n"
				+ "38.27,21,Group Change Event,Group Change,,9,1,New Group,35,,,,,,,,\r\n"
				+ "38.501,39,Input Transition Off Event,Tray #1,,35,0,,,,,,,,,,\r\n"
				+ "40.27,1,Condition Event,AfterReward_Pause,,35,0,,,,,,,,,,\r\n"
				+ "40.27,29,Timer Event,ITI_Timer,,35,1,Value,0,,,,,,,,\r\n"
				+ "40.27,16,Variable Event,After_Reward_Timer,,35,1,Value,2,,,,,,,,\r\n"
				+ "40.27,16,Variable Event,After_Reward_Timer,,35,1,Value,0,,,,,,,,\r\n"
				+ "40.27,21,Group Change Event,Group Change,,35,1,New Group,10,,,,,,,,\r\n"
				+ "45.27,1,Condition Event,Next trial,,10,0,,,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,ITI_Timer,,10,1,Value,5,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,ITI_Timer,,10,1,Value,0,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,SkipTrial_inc,,10,1,Value,0,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,First_Analysis,,10,1,Value,1,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,Hold_Timer,,10,1,Value,0.56,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,Hold_Timer,,10,1,Value,0,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,zzRT_Timer,,10,1,Value,0.385,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,zzRT_Timer,,10,1,Value,0,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,zzMT_Timer,,10,1,Value,0.179,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,zzMT_Timer,,10,1,Value,0,,,,,,,,\r\n"
				+ "45.27,21,Group Change Event,Group Change,,10,1,New Group,27,,,,,,,,\r\n"
				+ "45.27,1,Condition Event,Change Hold Time,,27,0,,,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,Hold_Time_Adjuster,,27,1,Value,0.194,,,,,,,,\r\n"
				+ "45.27,21,Group Change Event,Group Change,,27,1,New Group,3,,,,,,,,\r\n"
				+ "45.27,1,Condition Event,First 10 trials,,3,0,,,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,_Trial_Counter,,3,1,Value,1,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,Correct_Percent,,3,1,Value,1,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,Correct_Percent,,3,1,Value,1,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,Correct_Percent,,3,1,Value,100,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,Accuracy_NoAE,,3,1,Value,1,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,Accuracy_NoAE,,3,1,Value,1,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,Accuracy_NoAE,,3,1,Value,100,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,Trial_Type,,3,1,Value,331,,,,,,,,\r\n"
				+ "45.27,19,List Change - Next Value,First_10_Trial,,3,2,Index,4,Value,113,,,,,,\r\n"
				+ "45.27,16,Variable Event,Cue_Brightness,,3,1,Value,25,,,,,,,,\r\n"
				+ "45.27,19,List Change - Next Value,Valid_CueBrightness,,3,2,Index,3,Value,70,,,,,,\r\n"
				+ "45.27,21,Group Change Event,Group Change,,3,1,New Group,4,,,,,,,,\r\n"
				+ "45.27,1,Condition Event,Select Trial Type,,4,0,,,,,,,,,,\r\n"
				+ "45.27,32,Whisker - Display Image,Posner task,Image,4,2,Position,4,CentralStimulus,0,,,,,,\r\n"
				+ "45.27,16,Variable Event,aTrial_Set,,4,1,Value,331,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,Hold_Time,,4,1,Value,0.194,,,,,,,,\r\n"
				+ "45.27,21,Group Change Event,Group Change,,4,1,New Group,5,,,,,,,,\r\n"
				+ "45.27,1,Condition Event,Trial set 331,,5,0,,,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,Cue_Position,,5,1,Value,3,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,Target_Position,,5,1,Value,3,,,,,,,,\r\n"
				+ "45.27,16,Variable Event,Incorrect_Position,,5,1,Value,1,,,,,,,,\r\n"
				+ "45.27,21,Group Change Event,Group Change,,5,1,New Group,15,,,,,,,,\r\n"
				+ "63.821,30,Touch Down Event,Posner task,,15,4,Position,4,CentralStimulus,0,CoordX,36,CoordY,56,,\r\n"
				+ "63.822,1,Condition Event,Display Cue 25,,15,0,,,,,,,,,,\r\n"
				+ "63.822,32,Whisker - Display Image,Posner task,Image,15,2,Position,4,dim,2,,,,,,\r\n"
				+ "63.822,32,Whisker - Display Image,Posner task,Image,15,2,Position,3,Cue25,5,,,,,,\r\n"
				+ "63.822,29,Timer Event,Hold_Timer,,15,1,Value,0,,,,,,,,\r\n"
				+ "63.822,21,Group Change Event,Group Change,,15,1,New Group,37,,,,,,,,\r\n"
				+ "63.972,1,Condition Event,Hold_Cue,,37,0,,,,,,,,,,\r\n"
				+ "63.972,32,Whisker - Display Image,Posner task,Background,37,2,Position,3,Image 1,0,,,,,,\r\n"
				+ "63.972,21,Group Change Event,Group Change,,37,1,New Group,16,,,,,,,,\r\n"
				+ "64.016,1,Condition Event,Hold_CTI,,16,0,,,,,,,,,,\r\n"
				+ "64.016,32,Whisker - Display Image,Posner task,Image,16,2,Position,3,Target,1,,,,,,\r\n"
				+ "64.016,16,Variable Event,Hold_Failure_Counter,,16,1,Value,0,,,,,,,,\r\n"
				+ "64.016,29,Timer Event,zzRT_Timer,,16,1,Value,0,,,,,,,,\r\n"
				+ "64.016,29,Timer Event,Target_Timer,,16,1,Value,0,,,,,,,,\r\n"
				+ "64.016,21,Group Change Event,Group Change,,16,1,New Group,7,,,,,,,,\r\n"
				+ "65.016,1,Condition Event,Hold_During Target,,7,0,,,,,,,,,,\r\n"
				+ "65.016,32,Whisker - Display Image,Posner task,Background,7,2,Position,3,Image 1,0,,,,,,\r\n"
				+ "65.016,16,Variable Event,Target_Timer,,7,1,Value,1,,,,,,,,\r\n"
				+ "65.016,16,Variable Event,Target_Timer,,7,1,Value,0,,,,,,,,\r\n"
				+ "65.016,21,Group Change Event,Group Change,,7,1,New Group,8,,,,,,,,\r\n"
				+ "65.045,31,Touch Up Event,Posner task,,8,4,Position,4,dim,2,CoordX,12,CoordY,75,,\r\n"
				+ "65.046,1,Condition Event,Response_After Target,,8,0,,,,,,,,,,\r\n"
				+ "65.046,16,Variable Event,zzRT_Timer,,8,1,Value,1.03,,,,,,,,\r\n"
				+ "65.046,16,Variable Event,Hold_Timer,,8,1,Value,1.224,,,,,,,,\r\n"
				+ "65.046,32,Whisker - Display Image,Posner task,Background,8,2,Position,4,Image 1,0,,,,,,\r\n"
				+ "65.046,29,Timer Event,zzMT_Timer,,8,1,Value,0,,,,,,,,\r\n"
				+ "65.046,21,Group Change Event,Group Change,,8,1,New Group,30,,,,,,,,\r\n"
				+ "65.293,30,Touch Down Event,Posner task,,30,4,Position,3,Image 1,0,CoordX,45,CoordY,167,,\r\n"
				+ "65.294,1,Condition Event,Correct,,30,0,,,,,,,,,,\r\n"
				+ "65.294,7,Pulse Output Event,Feeder #1,,30,1,Duration,0.28,,,,,,,,\r\n"
				+ "65.294,3,Output On Event,TrayLight #1,,30,0,,,,,,,,,,\r\n"
				+ "65.294,7,Pulse Output Event,Sound_On #1,,30,1,Duration,1,,,,,,,,\r\n"
				+ "65.294,16,Variable Event,zzMT_Timer,,30,1,Value,0.247,,,,,,,,\r\n"
				+ "65.294,21,Group Change Event,Group Change,,30,1,New Group,9,,,,,,,,\r\n"
				+ "65.294,1,Condition Event,Increment Correct_Counter,,9,0,,,,,,,,,,\r\n"
				+ "65.294,16,Variable Event,zz_Correct_Counter,,9,1,Value,2,,,,,,,,\r\n"
				+ "65.294,16,Variable Event,Hold_Success_Counter,,9,1,Value,2,,,,,,,,\r\n"
				+ "65.294,16,Variable Event,aCounter_NoAE,,9,1,Value,2,,,,,,,,\r\n"
				+ "65.294,16,Variable Event,First_Analysis,,9,1,Value,0,,,,,,,,\r\n"
				+ "65.294,16,Variable Event,Change_Hold_Time,,9,1,Value,1,,,,,,,,\r\n"
				+ "65.294,61,Group Maintain Event,Group Change,,9,1,New Group,9,,,,,,,,\r\n"
				+ "65.428,31,Touch Up Event,Posner task,,9,4,Position,3,Image 1,0,CoordX,38,CoordY,176,,\r\n"
				+ "85.594,38,Input Transition On Event,BIRBeam #1,,9,0,,,,,,,,,,\r\n"
				+ "85.649,39,Input Transition Off Event,BIRBeam #1,,9,0,,,,,,,,,,\r\n"
				+ "85.89,38,Input Transition On Event,Tray #1,,9,0,,,,,,,,,,\r\n"
				+ "85.89,1,Condition Event,Reward Collected,,9,0,,,,,,,,,,\r\n"
				+ "85.89,4,Output Off Event,TrayLight #1,,9,0,,,,,,,,,,\r\n"
				+ "85.89,29,Timer Event,After_Reward_Timer,,9,1,Value,0,,,,,,,,\r\n"
				+ "85.89,16,Variable Event,Reward_counter,,9,1,Value,2,,,,,,,,\r\n"
				+ "85.89,21,Group Change Event,Group Change,,9,1,New Group,35,,,,,,,,\r\n"
				+ "86.066,39,Input Transition Off Event,Tray #1,,35,0,,,,,,,,,,\r\n"
				+ "87.89,1,Condition Event,AfterReward_Pause,,35,0,,,,,,,,,,\r\n"
				+ "87.89,29,Timer Event,ITI_Timer,,35,1,Value,0,,,,,,,,\r\n"
				+ "87.89,16,Variable Event,After_Reward_Timer,,35,1,Value,2,,,,,,,,\r\n"
				+ "87.89,16,Variable Event,After_Reward_Timer,,35,1,Value,0,,,,,,,,\r\n"
				+ "87.89,21,Group Change Event,Group Change,,35,1,New Group,10,,,,,,,,\r\n"
				+ "92.89,1,Condition Event,Next trial,,10,0,,,,,,,,,,\r\n"
				+ "92.89,16,Variable Event,ITI_Timer,,10,1,Value,5,,,,,,,,\r\n"
				+ "92.89,16,Variable Event,ITI_Timer,,10,1,Value,0,,,,,,,,\r\n"
				+ "92.89,16,Variable Event,SkipTrial_inc,,10,1,Value,0,,,,,,,,\r\n"
				+ "92.89,16,Variable Event,First_Analysis,,10,1,Value,1,,,,,,,,";
		Event[] events = Event.readEventsFromString(input);
		MPosnerProbeTrialPartitioner sut = new MPosnerProbeTrialPartitioner();
		
		List<Trial> trials = sut.partition(events);
		
		assertEquals(2,trials.size());
		int numberOfEvents = trials.get(1).copyEventsAsArray().length;
		assertEquals("Next trial", trials.get(1).copyEventsAsArray()[numberOfEvents-1].getItem_Name());
	}
	
	@Test
	void partitioner_does_not_recognize_incomplete_trial() {
		String input = "0.004,1,Condition Event,Set Blank Images,,1,0,,,,,,,,,,\r\n"
				+ "0.004,32,Whisker - Display Image,Posner task,Background,1,2,Position,1,Image 1,0,,,,,,\r\n"
				+ "0.004,32,Whisker - Display Image,Posner task,Background,1,2,Position,2,Image 1,0,,,,,,\r\n"
				+ "0.004,32,Whisker - Display Image,Posner task,Background,1,2,Position,3,Image 1,0,,,,,,\r\n"
				+ "0.004,3,Output On Event,White_Noise_Off #1,,1,0,,,,,,,,,,\r\n"
				+ "0.004,21,Group Change Event,Group Change,,1,1,New Group,22,,,,,,,,\r\n"
				+ "0.1,1,Condition Event,Reset Sound Levels to Zero,,22,0,,,,,,,,,,\r\n"
				+ "0.1,4,Output Off Event,Sound #1,,22,0,,,,,,,,,,\r\n"
				+ "0.1,4,Output Off Event,Sound #2,,22,0,,,,,,,,,,\r\n"
				+ "0.1,4,Output Off Event,Sound #3,,22,0,,,,,,,,,,\r\n"
				+ "0.1,21,Group Change Event,Group Change,,22,1,New Group,23,,,,,,,,\r\n"
				+ "0.1,1,Condition Event,Adjust Sound Level 2,,23,0,,,,,,,,,,\r\n"
				+ "0.1,3,Output On Event,Sound #2,,23,0,,,,,,,,,,\r\n"
				+ "0.1,1,Condition Event,NoTone Fall Through,,23,0,,,,,,,,,,\r\n"
				+ "0.1,21,Group Change Event,Group Change,,23,1,New Group,24,,,,,,,,\r\n"
				+ "0.1,1,Condition Event,Tone set,,24,0,,,,,,,,,,\r\n"
				+ "0.1,21,Group Change Event,Group Change,,24,1,New Group,2,,,,,,,,\r\n"
				+ "0.1,1,Condition Event,Free Feed,,2,0,,,,,,,,,,\r\n"
				+ "0.1,3,Output On Event,TrayLight #1,,2,0,,,,,,,,,,\r\n"
				+ "0.1,7,Pulse Output Event,Feeder #1,,2,1,Duration,0.28,,,,,,,,\r\n"
				+ "0.1,7,Pulse Output Event,Sound_On #1,,2,1,Duration,1,,,,,,,,\r\n"
				+ "0.1,16,Variable Event,SkipTrial_inc,,2,1,Value,1,,,,,,,,\r\n"
				+ "0.1,21,Group Change Event,Group Change,,2,1,New Group,3,,,,,,,,\r\n"
				+ "19.998,38,Input Transition On Event,Tray #1,,3,0,,,,,,,,,,\r\n"
				+ "19.998,1,Condition Event,Tray Entry starts first trial,,3,0,,,,,,,,,,\r\n"
				+ "19.998,4,Output Off Event,TrayLight #1,,3,0,,,,,,,,,,\r\n"
				+ "19.998,16,Variable Event,Trial_Type,,3,1,Value,14513,,,,,,,,\r\n"
				+ "19.998,19,List Change - Next Value,First_10_Trial,,3,2,Index,6,Value,14513,,,,,,\r\n"
				+ "19.998,16,Variable Event,Starting_Validity,,3,1,Value,12,,,,,,,,\r\n"
				+ "19.998,17,List Change - Set,Validity_List,,3,2,Index,12,Value,0,,,,,,\r\n"
				+ "19.998,16,Variable Event,Cue_Brightness,,3,1,Value,50,,,,,,,,\r\n"
				+ "19.998,19,List Change - Next Value,Valid_CueBrightness,,3,2,Index,7,Value,25,,,,,,\r\n"
				+ "19.998,21,Group Change Event,Group Change,,3,1,New Group,4,,,,,,,,\r\n"
				+ "19.998,1,Condition Event,Select Trial Type,,4,0,,,,,,,,,,\r\n"
				+ "19.998,32,Whisker - Display Image,Posner task,Image,4,2,Position,4,CentralStimulus,0,,,,,,\r\n"
				+ "19.998,16,Variable Event,aTrial_Set,,4,1,Value,14513,,,,,,,,\r\n"
				+ "19.998,16,Variable Event,Hold_Time,,4,1,Value,0.175,,,,,,,,\r\n"
				+ "19.998,21,Group Change Event,Group Change,,4,1,New Group,5,,,,,,,,\r\n"
				+ "19.998,1,Condition Event,Trial set 14513,,5,0,,,,,,,,,,\r\n"
				+ "19.998,16,Variable Event,Cue_Left,,5,1,Value,1,,,,,,,,\r\n"
				+ "19.998,16,Variable Event,Cue_Right,,5,1,Value,0,,,,,,,,\r\n"
				+ "19.998,16,Variable Event,Target_Position,,5,1,Value,1,,,,,,,,\r\n"
				+ "19.998,16,Variable Event,Incorrect_Position,,5,1,Value,3,,,,,,,,\r\n"
				+ "19.998,21,Group Change Event,Group Change,,5,1,New Group,15,,,,,,,,\r\n"
				+ "20.183,39,Input Transition Off Event,Tray #1,,15,0,,,,,,,,,,\r\n"
				+ "20.597,30,Touch Down Event,Posner task,,15,4,Position,4,CentralStimulus,0,CoordX,37,CoordY,79,,\r\n"
				+ "20.597,1,Condition Event,Display Left Cue 50,,15,0,,,,,,,,,,\r\n"
				+ "20.597,32,Whisker - Display Image,Posner task,Cue_Images,15,2,Position,4,LeftCue50,5,,,,,,\r\n"
				+ "20.597,29,Timer Event,Hold_Timer,,15,1,Value,0,,,,,,,,\r\n"
				+ "20.597,21,Group Change Event,Group Change,,15,1,New Group,37,,,,,,,,\r\n"
				+ "20.747,1,Condition Event,Hold_Cue,,37,0,,,,,,,,,,\r\n"
				+ "20.747,32,Whisker - Display Image,Posner task,Image,37,2,Position,4,dim,2,,,,,,\r\n"
				+ "20.747,21,Group Change Event,Group Change,,37,1,New Group,16,,,,,,,,\r\n"
				+ "20.772,1,Condition Event,Hold_CTI,,16,0,,,,,,,,,,\r\n"
				+ "20.772,32,Whisker - Display Image,Posner task,Image,16,2,Position,1,Target,1,,,,,,\r\n"
				+ "20.772,16,Variable Event,Hold_Failure_Counter,,16,1,Value,0,,,,,,,,\r\n"
				+ "20.772,29,Timer Event,zzRT_Timer,,16,1,Value,0,,,,,,,,\r\n"
				+ "20.772,29,Timer Event,Target_Timer,,16,1,Value,0,,,,,,,,\r\n"
				+ "20.772,21,Group Change Event,Group Change,,16,1,New Group,7,,,,,,,,\r\n"
				+ "21.173,31,Touch Up Event,Posner task,,7,4,Position,4,dim,2,CoordX,47,CoordY,71,,\r\n"
				+ "21.173,1,Condition Event,Leave_During Target,,7,0,,,,,,,,,,\r\n"
				+ "21.173,32,Whisker - Display Image,Posner task,Background,7,2,Position,4,Image 1,0,,,,,,\r\n"
				+ "21.173,16,Variable Event,zzRT_Timer,,7,1,Value,0.401,,,,,,,,\r\n"
				+ "21.173,16,Variable Event,Hold_Timer,,7,1,Value,0.576,,,,,,,,\r\n"
				+ "21.173,29,Timer Event,zzMT_Timer,,7,1,Value,0,,,,,,,,\r\n"
				+ "21.173,21,Group Change Event,Group Change,,7,1,New Group,25,,,,,,,,\r\n"
				+ "21.391,30,Touch Down Event,Posner task,,25,4,Position,1,Target,1,CoordX,107,CoordY,130,,\r\n"
				+ "21.391,1,Condition Event,Correct_Leaving During Target,,25,0,,,,,,,,,,\r\n"
				+ "21.391,32,Whisker - Display Image,Posner task,Background,25,2,Position,1,Image 1,0,,,,,,\r\n"
				+ "21.391,7,Pulse Output Event,Feeder #1,,25,1,Duration,0.28,,,,,,,,\r\n"
				+ "21.391,3,Output On Event,TrayLight #1,,25,0,,,,,,,,,,\r\n"
				+ "21.391,7,Pulse Output Event,Sound_On #1,,25,1,Duration,1,,,,,,,,\r\n"
				+ "21.391,16,Variable Event,Target_Timer,,25,1,Value,0.619,,,,,,,,\r\n"
				+ "21.391,16,Variable Event,Target_Timer,,25,1,Value,0,,,,,,,,\r\n"
				+ "21.391,16,Variable Event,zzMT_Timer,,25,1,Value,0.218,,,,,,,,\r\n"
				+ "21.391,21,Group Change Event,Group Change,,25,1,New Group,9,,,,,,,,\r\n"
				+ "21.391,1,Condition Event,Increment Correct_Counter,,9,0,,,,,,,,,,\r\n"
				+ "21.391,16,Variable Event,zz_Correct_Counter,,9,1,Value,1,,,,,,,,\r\n"
				+ "21.391,16,Variable Event,Hold_Success_Counter,,9,1,Value,1,,,,,,,,\r\n"
				+ "21.391,16,Variable Event,aCounter_NoAE,,9,1,Value,1,,,,,,,,\r\n"
				+ "21.391,16,Variable Event,First_Analysis,,9,1,Value,0,,,,,,,,\r\n"
				+ "21.391,16,Variable Event,Change_Hold_Time,,9,1,Value,1,,,,,,,,\r\n"
				+ "21.391,61,Group Maintain Event,Group Change,,9,1,New Group,9,,,,,,,,\r\n"
				+ "21.487,31,Touch Up Event,Posner task,,9,4,Position,1,Image 1,0,CoordX,100,CoordY,130,,\r\n"
				+ "23.195,38,Input Transition On Event,BIRBeam #1,,9,0,,,,,,,,,,\r\n"
				+ "23.298,39,Input Transition Off Event,BIRBeam #1,,9,0,,,,,,,,,,\r\n"
				+ "23.369,38,Input Transition On Event,Tray #1,,9,0,,,,,,,,,,\r\n"
				+ "23.369,1,Condition Event,Reward Collected,,9,0,,,,,,,,,,\r\n"
				+ "23.369,4,Output Off Event,TrayLight #1,,9,0,,,,,,,,,,\r\n"
				+ "23.369,29,Timer Event,After_Reward_Timer,,9,1,Value,0,,,,,,,,\r\n"
				+ "23.369,16,Variable Event,Reward_counter,,9,1,Value,1,,,,,,,,";
		Event[] events = Event.readEventsFromString(input);
		MPosnerProbeTrialPartitioner sut = new MPosnerProbeTrialPartitioner();
		
		List<Trial> trials = sut.partition(events);
		
		assertEquals(0,trials.size());
	}

}
